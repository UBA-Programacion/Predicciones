<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Laboratorio de Predicciones Cuantitativas</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet" />
  <style>
    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: "Inter", sans-serif;
    }

    .card {
      background-color: #1a1a1a;
      border: 1px solid #333;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
    }

    .btn {
      transition: all 0.2s;
    }

    .btn:hover {
      transform: scale(1.05);
    }

    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      background: #f97316;
      cursor: pointer;
      border-radius: 50%;
    }

    input[type="range"]::-moz-range-thumb {
      width: 20px;
      height: 20px;
      background: #f97316;
      cursor: pointer;
      border-radius: 50%;
    }

    /* Gemini Modal Styles */
    .modal-backdrop {
      background-color: rgba(0, 0, 0, 0.7);
    }

    .modal-content {
      background-color: #1e1e1e;
    }

    .loader {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #f97316;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }
  </style>
</head>

<body class="bg-black text-gray-200">
  <nav class="bg-gray-900/50 backdrop-blur-sm border-b border-gray-700 sticky top-0 z-50">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex items-center justify-between h-16">
        <div class="flex items-center">
          <div class="flex-shrink-0">
            <span class="text-white font-bold text-xl">Predicciones<span class="text-orange-500">.AI</span></span>
          </div>
        </div>
        <div class="hidden md:block">
          <div class="ml-10 flex items-baseline space-x-4">
            <a href="index.html#laboratorios"
              class="text-gray-300 hover:text-orange-400 px-3 py-2 rounded-md text-sm font-medium">Laboratorios</a>
            <a href="index.html#nosotros"
              class="text-gray-300 hover:text-orange-400 px-3 py-2 rounded-md text-sm font-medium">Nosotros</a>
            <a href="index.html#contacto"
              class="text-gray-300 hover:text-orange-400 px-3 py-2 rounded-md text-sm font-medium">Contacto</a>
          </div>
        </div>
        <div class="-mr-2 flex md:hidden">
          <button type="button" id="mobile-menu-button"
            class="bg-gray-800 inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-700 focus:outline-none"
            aria-controls="mobile-menu" aria-expanded="false">
            <span class="sr-only">Abrir men√∫</span>
            <svg id="hamburger-icon" class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
            <svg id="close-icon" class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
            </svg>
          </button>
        </div>
      </div>
    </div>
    <div class="md:hidden hidden" id="mobile-menu">
      <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
        <a href="index.html#laboratorios"
          class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Laboratorios</a>
        <a href="index.html#nosotros"
          class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Nosotros</a>
        <a href="index.html#contacto"
          class="text-gray-300 hover:bg-gray-700 hover:text-white block px-3 py-2 rounded-md text-base font-medium">Contacto</a>
      </div>
    </div>
  </nav>

  <div class="container mx-auto p-4 md:p-8">
    <header class="text-center my-12">
      <h1 class="text-4xl md:text-6xl font-black text-white">
        Laboratorio de Predicciones
        <span class="text-orange-500">Cuantitativas</span>
      </h1>
      <p class="text-gray-400 mt-4 max-w-2xl mx-auto">
        Jug√° con los modelos, mov√© las perillas y descubr√≠ c√≥mo la ciencia de
        datos adivina el futuro. ¬°De cero a ninja!
      </p>
    </header>

    <main class="space-y-16">
      <!-- Secci√≥n 1: Regresi√≥n Lineal -->
      <section id="regresion-lineal">
        <div class="flex justify-between items-start mb-8">
          <h2 class="text-3xl font-bold border-b-2 border-orange-500 pb-2">
            üî¢ 1. Regresi√≥n Lineal Simple
          </h2>
          <button
            class="btn gemini-btn bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded-lg whitespace-nowrap"
            data-model="Regresi√≥n Lineal Simple">
            ‚ú® Explic√°melo, Gemini
          </button>
        </div>
        <div class="card rounded-lg p-6">
          <div class="grid lg:grid-cols-2 gap-8">
            <div>
              <h3 class="text-2xl font-bold text-orange-400 mb-4">
                La Fiesta con Pizza üçï
              </h3>
              <p class="text-gray-400 mb-4">
                Este es el modelo m√°s simple. Su laburo es encontrar la mejor
                **l√≠nea recta** para predecir una cosa bas√°ndose en otra. En
                este caso, cu√°nta pizza comprar seg√∫n los amigos que vienen.
              </p>

              <div class="bg-gray-900 p-4 rounded-lg mb-6">
                <p class="font-mono text-center text-lg text-orange-400">
                  Y = mX + b
                </p>
                <ul class="text-sm mt-2 space-y-1 text-gray-300">
                  <li>
                    <span class="font-bold text-white">Y (La Predicci√≥n):</span>
                    <span class="text-gray-400">Porciones de Pizza a comprar.</span>
                  </li>
                  <li>
                    <span class="font-bold text-white">X (El Dato que Ten√©s):</span>
                    <span class="text-gray-400">Cantidad de Amigos.</span>
                  </li>
                  <li>
                    <span class="font-bold text-white">m (La Pendiente):</span>
                    <span class="text-gray-400">El "peso" de cada amigo. En nuestra simulaci√≥n, cada
                      amigo suma **3** porciones.</span>
                  </li>
                  <li>
                    <span class="font-bold text-white">b (El Punto de Partida):</span>
                    <span class="text-gray-400">Las porciones que comprar√≠as si no viniera nadie. Ac√°
                      es **0**.</span>
                  </li>
                </ul>
              </div>

              <div class="space-y-4 mb-6">
                <label for="amigosSlider" class="block font-medium">Mov√© la perilla para simular la
                  <span class="text-orange-400 font-bold">Cantidad de Amigos (X)</span>:
                  <span id="amigosValue" class="font-bold text-orange-400">5</span></label>
                <input id="amigosSlider" type="range" min="1" max="20" value="5"
                  class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer" />
              </div>

              <div class="bg-gray-800 border border-orange-500/50 p-4 rounded-lg text-center">
                <p class="text-lg">Predicci√≥n (Y):</p>
                <p class="text-4xl font-black text-white">
                  <span id="pizzaPrediction">15</span> Porciones
                </p>
              </div>
            </div>
            <div class="min-h-[400px]">
              <canvas id="pizzaChart"></canvas>
            </div>
          </div>
        </div>
      </section>

      <!-- Secci√≥n 2: Regresi√≥n M√∫ltiple -->
      <section id="regresion-multiple">
        <div class="flex justify-between items-start mb-8">
          <h2 class="text-3xl font-bold border-b-2 border-orange-500 pb-2">
            üèòÔ∏è 2. Regresi√≥n Lineal M√∫ltiple
          </h2>
          <button
            class="btn gemini-btn bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded-lg whitespace-nowrap"
            data-model="Regresi√≥n Lineal M√∫ltiple">
            ‚ú® Explic√°melo, Gemini
          </button>
        </div>
        <div class="card rounded-lg p-6">
          <div class="grid lg:grid-cols-2 gap-8">
            <div>
              <h3 class="text-2xl font-bold text-orange-400 mb-4">
                El Precio de una Casa üè°
              </h3>
              <p class="text-gray-400 mb-4">
                La vida real es m√°s complicada. Este modelo es la versi√≥n con
                esteroides: usa **varias cosas a la vez** para que la
                predicci√≥n sea mucho m√°s precisa y realista.
              </p>
              <div class="bg-gray-900 p-4 rounded-lg mb-6">
                <p class="font-mono text-center text-lg text-orange-400">
                  Y = b + m‚ÇÅX‚ÇÅ + m‚ÇÇX‚ÇÇ + m‚ÇÉX‚ÇÉ
                </p>
                <ul class="text-sm mt-2 space-y-1 text-gray-300">
                  <li>
                    <span class="font-bold text-white">Y (La Predicci√≥n):</span>
                    <span class="text-gray-400">Precio de la Casa.</span>
                  </li>
                  <li>
                    <span class="font-bold text-white">X‚ÇÅ, X‚ÇÇ, X‚ÇÉ (Los Datos):</span>
                    <span class="text-gray-400">Metros, Ambientes, Antig√ºedad.</span>
                  </li>
                  <li>
                    <span class="font-bold text-white">m‚ÇÅ, m‚ÇÇ, m‚ÇÉ (Los Pesos):</span>
                    <span class="text-gray-400">Cu√°nto suma o resta cada variable al precio.</span>
                  </li>
                  <li>
                    <span class="font-bold text-white">b (El Punto de Partida):</span>
                    <span class="text-gray-400">El valor base del terreno.</span>
                  </li>
                </ul>
              </div>

              <div class="space-y-4 mb-6">
                <div>
                  <label for="metrosSlider" class="block font-medium">Metros Cuadrados (X‚ÇÅ):
                    <span id="metrosValue" class="font-bold text-orange-400">100</span>
                    m¬≤</label>
                  <input id="metrosSlider" type="range" min="20" max="300" value="100"
                    class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer" />
                </div>
                <div>
                  <label for="ambientesSlider" class="block font-medium">Cantidad de Ambientes (X‚ÇÇ):
                    <span id="ambientesValue" class="font-bold text-orange-400">3</span></label>
                  <input id="ambientesSlider" type="range" min="1" max="8" value="3"
                    class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer" />
                </div>
                <div>
                  <label for="antiguedadSlider" class="block font-medium">Antig√ºedad (X‚ÇÉ):
                    <span id="antiguedadValue" class="font-bold text-orange-400">10</span>
                    a√±os</label>
                  <input id="antiguedadSlider" type="range" min="0" max="50" value="10"
                    class="w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer" />
                </div>
              </div>
            </div>

            <div class="flex flex-col justify-center items-center">
              <div class="bg-gray-800 border border-orange-500/50 p-6 rounded-lg text-center w-full">
                <p class="text-lg">Predicci√≥n de Precio (Y):</p>
                <p class="text-5xl font-black text-white">
                  USD <span id="casaPrediction">225,000</span>
                </p>
              </div>
              <div class="w-full mt-6 bg-gray-900 p-4 rounded-lg">
                <h4 class="font-bold text-center text-orange-400">
                  ¬øC√≥mo se compone el precio?
                </h4>
                <div id="priceBreakdown" class="text-sm mt-2 space-y-1">
                  <!-- Se llena con JS -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer class="text-center mt-16 text-gray-500">
      <p>Hecho con üßâ y ciencia de datos. Laboratorio de Predicciones.</p>
    </footer>
  </div>

  <!-- Gemini Modal -->
  <div id="gemini-modal" class="hidden fixed inset-0 z-50 overflow-y-auto" aria-labelledby="modal-title" role="dialog"
    aria-modal="true">
    <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
      <div class="fixed inset-0 modal-backdrop" aria-hidden="true"></div>
      <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
      <div
        class="inline-block align-bottom rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full modal-content border border-orange-500/50">
        <div class="px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
          <div class="sm:flex sm:items-start">
            <div
              class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-orange-600 sm:mx-0 sm:h-10 sm:w-10">
              ‚ú®
            </div>
            <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
              <h3 class="text-lg leading-6 font-medium text-white" id="modal-title">
                Explicaci√≥n de Gemini
              </h3>
              <div class="mt-4 border-b border-gray-700 pb-4">
                <label for="gemini-api-key-input" class="block text-sm font-medium text-gray-400">Tu Clave de API de
                  Gemini</label>
                <input type="password" id="gemini-api-key-input"
                  class="mt-1 block w-full bg-gray-900 border border-gray-600 rounded-md shadow-sm py-2 px-3 text-white focus:outline-none focus:ring-orange-500 focus:border-orange-500 sm:text-sm"
                  placeholder="Peg√° tu clave ac√°..." />
                <p class="mt-1 text-xs text-gray-500">
                  Consegu√≠ una clave gratis en
                  <a href="https://aistudio.google.com/app/apikey" target="_blank"
                    class="text-orange-400 hover:underline">Google AI Studio</a>.
                </p>
              </div>
              <p class="text-sm text-gray-400 my-4" id="modal-subtitle">
                P√≠dele a la IA que te explique este modelo.
              </p>

              <div class="my-4 space-x-2">
                <button class="prompt-btn btn bg-gray-700 hover:bg-orange-600 text-xs py-1 px-3 rounded-full"
                  data-style="simple">
                  Explicaci√≥n Simple
                </button>
                <button class="prompt-btn btn bg-gray-700 hover:bg-orange-600 text-xs py-1 px-3 rounded-full"
                  data-style="analogy">
                  Analog√≠a Creativa
                </button>
                <button class="prompt-btn btn bg-gray-700 hover:bg-orange-600 text-xs py-1 px-3 rounded-full"
                  data-style="business">
                  Para Negocios
                </button>
              </div>

              <div id="gemini-response-container"
                class="mt-4 p-3 bg-black/50 rounded-md min-h-[150px] max-h-[300px] overflow-y-auto">
                <div id="gemini-loader" class="hidden flex justify-center items-center h-full">
                  <div class="loader"></div>
                </div>
                <p id="gemini-response" class="text-gray-300"></p>
              </div>
            </div>
          </div>
        </div>
        <div class="px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
          <button id="close-modal-btn" type="button"
            class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-600 shadow-sm px-4 py-2 bg-gray-800 text-base font-medium text-white hover:bg-gray-700 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm">
            Cerrar
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- L√ìGICA PARA EL MEN√ö RESPONSIVO ---
    const mobileMenuButton = document.getElementById("mobile-menu-button");
    const mobileMenu = document.getElementById("mobile-menu");
    const hamburgerIcon = mobileMenuButton.querySelector("svg:first-child");
    const closeIcon = mobileMenuButton.querySelector("svg:last-child");

    mobileMenuButton.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden");
      hamburgerIcon.classList.toggle("hidden");
      closeIcon.classList.toggle("hidden");
    });

    // --- L√ìGICA PARA REGRESI√ìN LINEAL ---
    const amigosSlider = document.getElementById("amigosSlider");
    const amigosValue = document.getElementById("amigosValue");
    const pizzaPrediction = document.getElementById("pizzaPrediction");
    const pizzaChartCtx = document
      .getElementById("pizzaChart")
      .getContext("2d");
    let pizzaChart;

    const pizzaData = Array.from({ length: 30 }, () => {
      const amigos = Math.floor(Math.random() * 19) + 1;
      const porciones = amigos * 3 + (Math.random() - 0.5) * 6;
      return { x: amigos, y: Math.max(0, porciones) };
    });

    function updatePizzaPrediction() {
      const amigos = parseInt(amigosSlider.value);
      const prediccion = amigos * 3;
      amigosValue.textContent = amigos;
      pizzaPrediction.textContent = prediccion;
      updatePizzaChart(amigos, prediccion);
    }

    function updatePizzaChart(highlightX, highlightY) {
      if (pizzaChart) {
        pizzaChart.destroy();
      }
      pizzaChart = new Chart(pizzaChartCtx, {
        type: "scatter",
        data: {
          datasets: [
            {
              label: "Fiestas Anteriores",
              data: pizzaData,
              backgroundColor: "rgba(255, 255, 255, 0.2)",
            },
            {
              label: "L√≠nea de Regresi√≥n",
              data: [
                { x: 1, y: 3 },
                { x: 20, y: 60 },
              ],
              type: "line",
              borderColor: "#f97316",
              borderWidth: 2,
              pointRadius: 0,
            },
            {
              label: "Tu Predicci√≥n",
              data: [{ x: highlightX, y: highlightY }],
              backgroundColor: "#fbbf24",
              pointRadius: 8,
            },
          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            x: {
              title: {
                display: true,
                text: "Cantidad de Amigos (X)",
                color: "#9ca3af",
              },
              grid: { color: "rgba(255,255,255,0.1)" },
              ticks: { color: "#9ca3af" },
            },
            y: {
              title: {
                display: true,
                text: "Porciones de Pizza (Y)",
                color: "#9ca3af",
              },
              grid: { color: "rgba(255,255,255,0.1)" },
              ticks: { color: "#9ca3af" },
            },
          },
          plugins: { legend: { labels: { color: "#9ca3af" } } },
        },
      });
    }
    amigosSlider.addEventListener("input", updatePizzaPrediction);

    // --- L√ìGICA PARA REGRESI√ìN M√öLTIPLE ---
    const metrosSlider = document.getElementById("metrosSlider");
    const ambientesSlider = document.getElementById("ambientesSlider");
    const antiguedadSlider = document.getElementById("antiguedadSlider");
    const metrosValue = document.getElementById("metrosValue");
    const ambientesValue = document.getElementById("ambientesValue");
    const antiguedadValue = document.getElementById("antiguedadValue");
    const casaPrediction = document.getElementById("casaPrediction");
    const priceBreakdown = document.getElementById("priceBreakdown");

    const basePrice = 50000;
    const pricePerMeter = 1500;
    const pricePerRoom = 10000;
    const pricePerYear = -500;

    function updateCasaPrediction() {
      const metros = parseInt(metrosSlider.value);
      const ambientes = parseInt(ambientesSlider.value);
      const antiguedad = parseInt(antiguedadSlider.value);

      const metrosContribution = metros * pricePerMeter;
      const ambientesContribution = ambientes * pricePerRoom;
      const antiguedadContribution = antiguedad * pricePerYear;

      const prediccion =
        basePrice +
        metrosContribution +
        ambientesContribution +
        antiguedadContribution;

      metrosValue.textContent = metros;
      ambientesValue.textContent = ambientes;
      antiguedadValue.textContent = antiguedad;
      casaPrediction.textContent = prediccion.toLocaleString("es-AR");

      priceBreakdown.innerHTML = `
                <p>Valor Base del Terreno (b): <span class="float-right font-mono">$ ${basePrice.toLocaleString(
        "es-AR"
      )}</span></p>
                <p>+ Por Metros Cuadrados (m‚ÇÅX‚ÇÅ): <span class="float-right font-mono">$ ${metrosContribution.toLocaleString(
        "es-AR"
      )}</span></p>
                <p>+ Por Ambientes (m‚ÇÇX‚ÇÇ): <span class="float-right font-mono">$ ${ambientesContribution.toLocaleString(
        "es-ar"
      )}</span></p>
                <p>- Por Antig√ºedad (m‚ÇÉX‚ÇÉ): <span class="float-right font-mono text-red-400">$ ${antiguedadContribution.toLocaleString(
        "es-ar"
      )}</span></p>
                <hr class="border-gray-600 my-1">
                <p class="font-bold">Total Estimado (Y): <span class="float-right font-mono">$ ${prediccion.toLocaleString(
        "es-ar"
      )}</span></p>
            `;
    }

    [metrosSlider, ambientesSlider, antiguedadSlider].forEach((slider) => {
      slider.addEventListener("input", updateCasaPrediction);
    });

    // --- GEMINI API LOGIC ---
    const geminiModal = document.getElementById("gemini-modal");
    const closeModalBtn = document.getElementById("close-modal-btn");
    const geminiResponseEl = document.getElementById("gemini-response");
    const geminiLoader = document.getElementById("gemini-loader");
    const modalTitle = document.getElementById("modal-title");
    const apiKeyInput = document.getElementById("gemini-api-key-input");
    let currentModel = "";

    document.querySelectorAll(".gemini-btn").forEach((btn) => {
      btn.addEventListener("click", (e) => {
        currentModel = e.target.dataset.model;
        modalTitle.textContent = `Explicaci√≥n de ${currentModel}`;
        geminiResponseEl.innerHTML = "Seleccion√° un estilo de explicaci√≥n...";
        geminiModal.classList.remove("hidden");
      });
    });

    closeModalBtn.addEventListener("click", () => {
      geminiModal.classList.add("hidden");
    });

    document.querySelectorAll(".prompt-btn").forEach((btn) => {
      btn.addEventListener("click", async (e) => {
        const style = e.target.dataset.style;
        await callGemini(currentModel, style);
      });
    });

    async function callGemini(modelName, style) {
      const apiKey = apiKeyInput.value.trim() || "";
      if (!apiKey) {
        geminiResponseEl.innerHTML =
          '<span class="text-red-400">¬°Che, campe√≥n! Necesit√°s poner tu clave de API de Gemini para que esto funcione.</span>';
        apiKeyInput.focus();
        apiKeyInput.classList.add("border-red-500");
        return;
      }
      apiKeyInput.classList.remove("border-red-500");

      geminiLoader.classList.remove("hidden");
      geminiResponseEl.innerHTML = "";

      const prompts = {
        simple: `Explica qu√© es y para qu√© sirve el modelo de ${modelName} como si se lo contaras a un amigo en un bar. Usa un lenguaje simple, directo y con tonada argentina.`,
        analogy: `Explica el modelo de ${modelName} usando una analog√≠a creativa y f√°cil de entender para alguien que no sabe nada de machine learning, con un toque de humor argentino.`,
        business: `Explica c√≥mo una empresa podr√≠a usar el modelo de ${modelName} para ganar plata o mejorar su negocio. Dame un caso de uso pr√°ctico y concreto, bien argento.`,
      };

      const userQuery = prompts[style];
      const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
      const payload = { contents: [{ parts: [{ text: userQuery }] }] };

      try {
        const response = await fetch(apiUrl, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload),
        });
        if (!response.ok)
          throw new Error(`Error de la API: ${response.status}`);
        const result = await response.json();
        const text = result.candidates[0].content.parts[0].text;
        geminiResponseEl.innerHTML = text
          .replace(
            /\*\*(.*?)\*\*/g,
            '<strong class="text-orange-400">$1</strong>'
          )
          .replace(/\n/g, "<br>");
      } catch (error) {
        console.error("Error llamando a Gemini:", error);
        geminiResponseEl.innerHTML =
          '<span class="text-red-400">Hubo un problema al conectar con la IA. Verific√° tu clave de API y la consola.</span>';
      } finally {
        geminiLoader.classList.add("hidden");
      }
    }

    // Carga inicial
    window.addEventListener("load", () => {
      updatePizzaPrediction();
      updateCasaPrediction();
    });
  </script>
</body>

</html>